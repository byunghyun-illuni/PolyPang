# PolyPang — ArenaView 상세 기획서 (Arena Spec)

## 0. 목적

이 문서는 **PolyPang 인게임 ArenaView의 화면 구조, 레이어, 상태, 애니메이션**을 정의한다.

**대상:**
* 화면기획/디자이너: 레이아웃, 스타일 가이드
* 개발자: 좌표 시스템, 회전 로직, 상태 전환, 애니메이션 타이밍

---

## 1. 핵심 원칙: 내 Side 하단 고정

### 1.1 원칙

> **모든 플레이어는 자신의 Side가 화면 하단에 위치하도록 Arena가 회전되어 렌더링된다.**

```text
        다른 플레이어들
             ╱╲
            ╱  ╲
           ╱    ╲
          ╱______╲
         ═════════   ← 나는 항상 여기 (하단)
```

### 1.2 이유

* **조작 일관성**: 좌우 터치 입력이 항상 패들의 좌우 이동과 일치
* **시야 확보**: 손가락이 Arena를 가리지 않음
* **공정성**: 모든 플레이어가 동일한 조작 경험

### 1.3 구현 방식

각 클라이언트에서:

```
회전 각도 = -θ_myIndex
```

즉, 내 Side의 각도만큼 Arena 전체를 반대로 회전시켜서 내 Side가 하단(6시 방향)에 오도록 한다.

**예시 (5인 게임, 내가 P3인 경우):**
* P3의 원래 각도: θ_2 = 72° × 2 - 90° = 54°
* Arena 회전: -54° (또는 +306°)
* 결과: 내 Side가 하단에 위치

---

## 2. ArenaView 영역 및 좌표 시스템

### 2.1 화면 내 위치

인게임 화면(S04/S05) 기준:

```text
┌─────────────────────────────┐
│ Header (6%)                 │
├─────────────────────────────┤
│ 생존자 목록 (4%)            │
├─────────────────────────────┤
│                             │
│       ArenaView (52%)       │  ← 이 문서의 대상
│                             │
├─────────────────────────────┤
│ 조작 영역 (38%)             │
└─────────────────────────────┘
```

### 2.2 ArenaView 크기

* **정사각형 박스** 확보
* 크기: `min(화면폭, ArenaView영역높이) × 0.85`
* 예: 390px 폭, 438px 높이 → 약 330×330px 박스

### 2.3 논리 좌표계

* **중심**: (0, 0)
* **반지름 R**: ArenaView 박스의 38~42%
* **화면 좌표 변환**:
  ```
  screenX = centerX + x × scale
  screenY = centerY - y × scale  (위로 갈수록 y 증가)
  ```

---

## 3. 레이어 구조 (Z-Order)

낮은 번호가 뒤쪽, 높은 번호가 앞쪽:

| Layer | 이름 | 설명 |
|-------|------|------|
| L0 | 배경 | 그라데이션/패턴 (옵션, 약하게) |
| L1 | Arena Base | 정N각형 외곽선 |
| L2 | Side Ownership | 각 Side 색상 띠/마커 |
| L3 | Paddle | 패들들 (내 패들 강조) |
| L4 | Ball | 공 + 트레일 |
| L5 | Labels | 닉네임, 상태 텍스트 |
| L6 | Pang Effects | HIT/OUT 이펙트 |
| L7 | Overlay | 이모지, 카운트다운, "GO!" |

---

## 4. Arena 요소별 스펙

### 4.1 정N각형 Border

* **선 두께**: 2~3px
* **색상**: 기본 #D0D0D0 (밝은 회색)
* **OUT 직후**: 0.3초간 밝게 → 복귀

### 4.2 Side 표시

각 변(Side)이 누구 영역인지 명확히:

**방식 1: Side 색상 띠**
* 변의 중앙 50~60% 구간에 플레이어 색상 적용
* 내 Side: 노란색 (#FCD34D), 더 두껍게 (4px)
* 다른 Side: 각자 색상, 기본 두께 (2px)

**방식 2: Side 마커**
* 변 중앙 바깥쪽에 작은 원/삼각형
* 플레이어 색상으로 채움

### 4.3 플레이어 닉네임/아이콘

**위치:**
* Side 중점에서 **바깥쪽으로 R × 0.12~0.15** 떨어진 위치
* 공식: `(R_label × cos(θ), R_label × sin(θ))` where `R_label = R × 1.12~1.15`

**스타일:**
| 상태 | 스타일 |
|------|--------|
| Alive | 플레이어 색상, 이모지 + 닉네임 |
| OUT | 회색, 반투명 (opacity 0.4) |
| 나 (Alive) | 노란색 강조, "YOU" 또는 밑줄 |

---

## 5. Paddle 스펙

### 5.1 형태

* **모양**: 둥근 끝 직선 막대 (라운드 캡)
* **길이**: Side 길이 × 0.3 (α = 0.3)
* **두께**: Arena 크기 × 0.03~0.04

### 5.2 색상 & 강조

| 패들 | 색상 | 두께 | 추가 효과 |
|------|------|------|-----------|
| 다른 플레이어 | 각자 플레이어 색상 | 기본 (6px) | 없음 |
| **내 패들** | **노란색 (#FCD34D)** | **굵게 (8px)** | **글로우 효과 (옵션)** |

### 5.3 위치 & 이동

* **위치**: 해당 Side 선 위
* **이동 범위**: Side 중심 기준 ± (Side 길이 × 0.3) = β = 0.6
* **이동 방향**: Side의 접선 방향 (탄젠트 벡터)

**패들 위치 공식:**
```
paddle_center(s) = side_center + tangent × s
```
* s ∈ [-move_range/2, +move_range/2]
* tangent = (-sin(θ), cos(θ))

---

## 6. Ball 스펙

### 6.1 형태

* **모양**: 원
* **직경**: Arena 크기 × 0.025~0.035
* **색상**: 흰색/밝은 색 (#FFFFFF 또는 #F87171)

### 6.2 트레일

* **길이**: Ball 직경 × 2~3배
* **스타일**: 점점 투명해지는 잔상
* **HIT 직후**: 0.3초간 더 길고 밝게

---

## 7. Pang 이펙트 상세

### 7.1 HIT Pang (소형)

**트리거**: Ball ↔ Paddle 충돌

**시각 요소:**
* 충돌 지점에서 별/조각 4~6개 퍼져나감
* 크기: Ball 직경 × 1.5~2배 범위
* 색상: Paddle 색상 + 화이트 혼합
* 지속: 0.2초

**사운드**: 짧은 "팅/핑"

### 7.2 OUT Pang (대형)

**트리거**: Ball이 Side 통과 (미스)

**타임라인:**

| 시간 | 연출 |
|------|------|
| 0.0s | Ball이 Side 통과, OUT 판정 |
| 0.0~0.2s | Side 라인 밝게 빛남 + 금 가는 애니메이션 |
| 0.2~0.6s | Side 조각(6~10개) 바깥으로 흩어짐 |
| 0.2~0.3s | 카메라 쉐이크 (강도: Arena 폭 × 0.01~0.02) |
| 0.2~0.7s | Arena 전체 펄싱 (확대-축소) |
| 0.5~1.0s | 정(N-1)각형으로 리메시 애니메이션 |

**시각 요소:**
* Side 파편: 6~10개 조각, 0.3~0.4초 후 페이드아웃
* 충격파: OUT Side 중점에서 동심원 링 1회 퍼짐
* 카메라 쉐이크: 0.15~0.25초, 가벼운 흔들림

**사운드**: "Pang!" (강한 타격음)

---

## 8. 상태별 ArenaView 표현

### 8.1 평상시 (INGAME)

* Arena: 정N각형, 안정된 색상
* Paddle: 각자 색상, 내 패들 강조
* Ball: 기본 트레일
* 이모지: 관전자 이모지 작게 떠다님 (있을 경우)

### 8.2 카운트다운 (COUNTDOWN)

* Arena: 어둡게 (그레이 오버레이 30%)
* 중앙: 큰 숫자 (3, 2, 1, GO!) - 펄스 애니메이션
* 입력: 무시

### 8.3 OUT 직후 (슬로우타임)

* Ball: 느린 움직임 (0.5배속)
* Arena: OUT Pang 이펙트 + 펄싱
* 지속: 0.5~0.7초
* 이후: 리메시 애니메이션 → 정상 속도 복귀

### 8.4 관전 모드 (SPECTATOR)

* Arena: 동일하게 렌더링 (내 회전 기준 유지)
* 내 Side/패들: 없음 (이미 OUT)
* 상단: "관전 중" 라벨
* 하단: EmojiBar (Arena 바깥)

---

## 9. 좌표 공식 정리

### 9.1 각도 컨벤션

```
θ_i = (360° / N) × i - 90°
```
* i = 0 → 12시 방향 (Top)
* 시계방향으로 증가

### 9.2 내 Side 하단 고정을 위한 회전

```
rotation = -θ_myIndex
```

Arena 전체를 이 각도만큼 회전하여 렌더링

### 9.3 Side 중심 좌표

```
center_i = (R × cos(θ_i), R × sin(θ_i))
```

화면 좌표:
```
screenX = canvasCenterX + center_i.x × scale
screenY = canvasCenterY - center_i.y × scale
```

### 9.4 라벨 좌표

```
R_label = R × 1.12~1.15
label_i = (R_label × cos(θ_i), R_label × sin(θ_i))
```

### 9.5 패들 이동 방향 (탄젠트)

```
t_i = (-sin(θ_i), cos(θ_i))
```

패들 위치:
```
paddle_center(s) = center_i + t_i × s
s ∈ [-move_range/2, +move_range/2]
```

---

## 10. N별 배치 테이블

### 10.1 N = 8 (8인 게임)

| Player | i | θ_i | 위치 설명 |
|--------|---|-----|-----------|
| P1 | 0 | -90° | 12시 (Top) |
| P2 | 1 | -45° | 1~2시 |
| P3 | 2 | 0° | 3시 (Right) |
| P4 | 3 | 45° | 4~5시 |
| P5 | 4 | 90° | 6시 (Bottom) |
| P6 | 5 | 135° | 7~8시 |
| P7 | 6 | 180° | 9시 (Left) |
| P8 | 7 | 225° | 10~11시 |

### 10.2 N = 5 (5인 게임)

| Player | i | θ_i | 위치 설명 |
|--------|---|-----|-----------|
| P1 | 0 | -90° | 12시 |
| P2 | 1 | -18° | 1~2시 |
| P3 | 2 | 54° | 4시 |
| P4 | 3 | 126° | 7~8시 |
| P5 | 4 | 198° | 10~11시 |

### 10.3 N = 3 (3인 게임)

| Player | i | θ_i | 위치 설명 |
|--------|---|-----|-----------|
| P1 | 0 | -90° | 12시 (Top) |
| P2 | 1 | 30° | 4시 |
| P3 | 2 | 150° | 8시 |

### 10.4 N = 2 (2인 게임, 최종 대결)

| Player | i | θ_i | 위치 설명 |
|--------|---|-----|-----------|
| P1 | 0 | -90° | 12시 (Top) |
| P2 | 1 | 90° | 6시 (Bottom) |

---

## 11. 색상 팔레트 (8인용)

| Player | 색상 | Hex |
|--------|------|-----|
| P1 | 빨강 | #EF4444 |
| P2 | 주황 | #F97316 |
| P3 | 노랑 | #EAB308 |
| P4 | 초록 | #22C55E |
| P5 | 청록 | #06B6D4 |
| P6 | 파랑 | #3B82F6 |
| P7 | 보라 | #8B5CF6 |
| P8 | 분홍 | #EC4899 |

**내 패들 색상 (별도):** 노란색 강조 #FCD34D

---

## 12. 반응형 대응

### 12.1 모바일 (기본)

* ArenaView: 화면 폭의 85%
* 라벨 크기: `fontSize = R × 0.07~0.09`

### 12.2 태블릿/PC

* ArenaView: 중앙 고정, max 400px
* 좌측: Alive 플레이어 목록 (확장)
* 우측: 관전자 이모지/채팅 (향후)

---

## 13. 개발자/디자이너 핸드오프

### 디자이너에게:

1. **N = 8, 5, 3, 2** 각각의 Arena 스크린샷 4장
2. 각 경우:
   * 색상 팔레트 적용 예시
   * 내 패들 강조 스타일
   * OUT 이펙트 시퀀스 (3~4 프레임)
3. HIT Pang vs OUT Pang 이펙트 비교

### 개발자에게:

1. **내 Side 하단 고정**: `rotation = -θ_myIndex`로 Arena 회전
2. 정N각형 좌표: 위 공식으로 동적 생성
3. Pang 이펙트: 재사용 가능한 파티클 시스템
   * HIT: 작은 규모, 짧은 지속
   * OUT: 큰 규모, 긴 지속 + 카메라 쉐이크
4. 리메시 애니메이션: 0.5초, ease-in-out